<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title | default("ReadGood") }}</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='index.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='navbar.css') }}">
</head>

<body>
    <nav class="navbar">
        <!-- Logo -->
        <a href="{{ url_for('home') }}" class="logo">
            <img src="{{ url_for('static', filename='logo.svg') }}" alt="ReadGood Logo" />
            <span>ReadGood</span>
        </a>

        <!-- Hamburger Menu Button -->
        <button class="hamburger" id="hamburger" aria-label="Toggle navigation">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <!-- Navigation Links -->
        <div class="nav-center" id="navCenter">
            <a href="{{ url_for('home') }}">Home</a>
            <a href="{{ url_for('user_books') }}">My Books</a>
            
            <!-- Top Genres Dropdown -->
            <div class="dropdown">
                <button class="dropdown-btn">
                    Top Genres <i class="fas fa-chevron-down"></i>
                </button>
                <div class="dropdown-content">
                    <a href="{{ url_for('books_by_genre', code='FIC') }}">Fiction</a>
                    <a href="{{ url_for('books_by_genre', code='FAN') }}">Fantasy</a>
                    <a href="{{ url_for('books_by_genre', code='ROM') }}">Romance</a>
                    <a href="{{ url_for('books_by_genre', code='MYS') }}">Mystery</a>
                    <a href="{{ url_for('books_by_genre', code='THR') }}">Thriller</a>
                </div>
            </div>
            
            <!-- Top Authors Dropdown -->
            <div class="dropdown">
                <button class="dropdown-btn">
                    Top Authors <i class="fas fa-chevron-down"></i>
                </button>
                <div class="dropdown-content">
                    <a href="{{ url_for('books_by_author', code='SK') }}">Stephen King</a>
                    <a href="{{ url_for('books_by_author', code='GM') }}">George R.R. Martin</a>
                    <a href="{{ url_for('books_by_author', code='WS') }}">William Shakespeare</a>
                    <a href="{{ url_for('books_by_author', code='HM') }}">Haruki Murakami</a>
                    <a href="{{ url_for('books_by_author', code='JA') }}">Jane Austen</a>
                </div>
            </div>
        </div>

        <!-- Right Side: Search & Logout -->
        <div class="nav-right">
            <!-- Search Bar -->
            <form class="search-bar" action="{{ url_for('search') }}" method="post">
                <input type="text" placeholder="Search Books" name="title" />
                <button type="submit"><i class="fa fa-search"></i></button>
            </form>
            
            <!-- Logout Button -->
            <a href="{{ url_for('logout') }}" class="logout-btn" title="Logout">
                <img src="{{ url_for('static', filename='logout.svg') }}" alt="Logout" />
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="flashes">
                    {% for category, message in messages %}
                        <li class="{{ category }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
        
        <!-- Page Content -->
        {% block content %}{% endblock %}
    </main>

    <!-- Hamburger Menu JavaScript -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const hamburger = document.getElementById('hamburger');
        const navCenter = document.getElementById('navCenter');
        
        if (hamburger && navCenter) {
            hamburger.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                // Toggle hamburger animation
                hamburger.classList.toggle('active');
                
                // Toggle mobile menu
                navCenter.classList.toggle('show');
                
                // Prevent body scroll when menu is open
                if (navCenter.classList.contains('show')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = '';
                }
            });

            // Close menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!hamburger.contains(e.target) && !navCenter.contains(e.target)) {
                    hamburger.classList.remove('active');
                    navCenter.classList.remove('show');
                    document.body.style.overflow = '';
                }
            });

            // Close menu when clicking nav links
            const navLinks = navCenter.querySelectorAll('a');
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    hamburger.classList.remove('active');
                    navCenter.classList.remove('show');
                    document.body.style.overflow = '';
                });
            });

            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    hamburger.classList.remove('active');
                    navCenter.classList.remove('show');
                    document.body.style.overflow = '';
                }
            });
        }
    });
    </script>
</body>
</html>